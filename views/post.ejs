<% include ./partials/header.ejs %>

<div class="posts parent mb-20">
    <!-- showing posts (use reverse fun on posts array)-->
     <!-- for each on posts array of user schema -->
    <% posts.reverse().forEach(function(elem){ %>
      <div class="post mt-10 w-full min-h-[50vh]">
        <div class="post mt-10 w-full min-h-[50vh]">
          <div class="title px-4 flex items-center gap-2">
              <a href="/user/profile/<%= elem.user.username %>" class="flex items-center space-x-2">
                <div class="w-[9vw] h-[9vw] bg-sky-100 rounded-full overflow-hidden">
                  <!-- <img class="w-full h-full object-cover" src="/images/uploads/<%= elem.user.profileImg %>" alt=""> -->
                </div>
                <h4 class="text-sm"> <%= elem.user.username %> </h4>
              </a>
            <h6 class="text-xs opacity-30">1d</h6>
          </div>
          <div class="w-full h-96 mt-4 bg-sky-100 overflow-hidden">
            <!-- in post schema img named as picture -->
            <!-- <img class="w-full h-full object-cover" src="/images/uploads/<%= elem.picture %>" alt=""> -->
          </div>
          <div class="options w-full px-4 flex justify-between items-center text-[1.4rem]" >
            <div class="flex gap-3 mt-2">
              <a href="/like/post/<%= elem._id %>">

                <!-- if user liked post, set filled heart -->
                <!-- this lines return indexOf not return -1 means user is present -->
                <% if(elem.likes.indexOf(user._id) !== -1 ){ %>
                  <i class="heart ri-heart-3-fill text-red-600"></i>
                <% } else { %>
                  <i class="heart ri-heart-3-line"></i>
                <% } %>
              </a>
              <i class="ri-chat-3-line"></i>
              <i class="ri-share-circle-line"></i>
            </div>
            <i class="save ri-bookmark-line"></i>
          </div>
          <h3 class="likeval px-4 mt-2 text-sm leading-none tracking-tight">
            <!-- showing length of likes array of post schema -->
            <%= elem.likes.length %> likes
          </h3>
          <h2 class="text-white font-light text-sm mt-2">
            <% if(elem.user._id.equals(user._id)) { %>
                <a href="/profile">
                    <span class="font-semibold pl-4 pr-2"><%= elem.user.username %></span>
                </a>
            <% } else { %>
                <span class="font-semibold pl-4 pr-2"><%= elem.user.username %></span>
            <% } %>
            <%= elem.caption %>
          </h2>
        </div>
      </div>
    <% }) %>
  </div>

<% include ./partials/footer.ejs %>
